<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ĐỌC NGHE SÁCH</title>
    <!-- Link Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Link Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            background: #1b1e21;
        }

        .line-right {
            border-right: 3px solid #1b1e21;
            box-shadow: 10px 0 10px rgba(0, 0, 0, 0.5);
        }

        .book-info-section {
            padding: 20px;
        }

        .book-cover {
            max-width: 100%;
            height: auto;
        }

        .content-section {
            position: sticky;
            top: 0;
            height: 1200px;
        }

        .iframe-container {
            width: 100%;
            height: 100%;
            overflow: auto; /* Ensure content is scrollable if needed */
        }

        /* Mobile Responsive Styles */
        @media (max-width: 991px) {
            .row {
                min-height: auto !important;
                flex-direction: column;
            }

            .line-right {
                border-right: none;
                border-bottom: 3px solid #1b1e21;
                box-shadow: 0 10px 10px rgba(0, 0, 0, 0.5);
            }

            .book-info-section {
                padding: 15px;
                order: 1;
            }

            .content-section {
                position: relative;
                height: auto; /* Allow dynamic height */
                order: 2;
                margin-top: 20px;
            }

            .book-cover {
                width: 150px;
                height: auto;
            }

            #tensach {
                font-size: 1.2rem;
                margin-bottom: 15px;
            }

            #tacgia {
                font-size: 1rem;
                margin-bottom: 15px;
            }

            #tomtat {
                font-size: 0.9rem;
                line-height: 1.5;
            }
        }

        @media (max-width: 768px) {
            .book-info-section {
                padding: 10px;
                text-align: center;
            }

            .content-section {
                height: auto;
                margin-top: 15px;
            }

            .book-cover {
                width: 120px;
                margin-bottom: 15px;
            }

            #tensach {
                font-size: 1.1rem;
                margin-bottom: 10px;
                padding: 0 10px;
            }

            #tacgia {
                font-size: 0.95rem;
                margin-bottom: 10px;
            }

            #tomtat {
                font-size: 0.85rem;
                line-height: 1.4;
                text-align: left;
                padding: 0 15px;
                max-height: 200px;
                overflow-y: auto;
            }

            hr {
                margin: 15px 0;
            }
        }

        @media (max-width: 576px) {
            .container-fluid {
                padding-left: 10px;
                padding-right: 10px;
            }

            .book-info-section {
                padding: 8px;
            }

            .content-section {
                height: auto;
                margin-top: 10px;
            }

            .book-cover {
                width: 100px;
                margin-bottom: 10px;
            }

            #tensach {
                font-size: 1rem;
                margin-bottom: 8px;
                padding: 0 5px;
                word-wrap: break-word;
            }

            #tacgia {
                font-size: 0.9rem;
                margin-bottom: 8px;
            }

            #tomtat {
                font-size: 0.8rem;
                line-height: 1.3;
                padding: 0 10px;
                max-height: 150px;
                overflow-y: auto;
            }

            hr {
                margin: 10px 0;
            }
        }

        @media (max-width: 400px) {
            .book-cover {
                width: 80px;
            }

            #tensach {
                font-size: 0.95rem;
            }

            #tacgia {
                font-size: 0.85rem;
            }

            #tomtat {
                font-size: 0.75rem;
                max-height: 120px;
                padding: 0 8px;
            }

            .content-section {
                height: auto;
            }
        }

        /* Scrollbar styling for tomtat */
        #tomtat::-webkit-scrollbar {
            width: 4px;
        }

        #tomtat::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        #tomtat::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
        }

        #tomtat::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row" style="min-height: 1200px;">
            <div class="col-lg-3 text-white line-right">
                <div class="container-fluid book-info-section">
                    <h4 class="text-center mt-4" id="tensach"></h4>
                    <br>
                    <span href="#" class="navbar-brand justify-content-center d-flex">
                        <img class="rounded-3 book-cover" width="180px" alt="" id="anh1">
                    </span>

                    <h5 class="text-center mt-4"><i style="font-family: 'Courier New', Courier, monospace;" id="tacgia"></i></h5>
                    <hr>
                    <span style="text-align: justify; display: block; line-height: 1.6;" id="tomtat">

                    </span>
                </div>
            </div>
            <div class="col-lg-9 text-white content-section">
                <div class="iframe-container">
                    <iframe id="contentFrame" src="Doc-Nghe-Sach-Right.html" frameborder="0" width="100%"
                        height="100%" style="min-height: 500px;"></iframe>
                </div>
            </div>
        </div>
    </div>
    <script>
        const book = JSON.parse(localStorage.getItem('book') || []);
        function loadPage(pageUrl) {
            document.getElementById('contentFrame').src = pageUrl;
        }

        document.getElementById("tensach").textContent = book[0].TENSACH;
        document.getElementById("tacgia").textContent = book[0].TACGIA;
        document.getElementById("anh1").src = book[0].ANHBIA;
        document.getElementById("tomtat").textContent = book[0].TOMTAT;

        // Handle messages from iframe
        window.addEventListener("message", function (event) {
            if (event.data && event.data.height) {
                const iframe = document.getElementById("contentFrame");
                if (iframe) {
                    iframe.style.height = event.data.height + "px"; // Use the exact height sent
                }
            }
        });

        // Handle page load and resize
        window.addEventListener("load", function () {
            const iframe = document.getElementById("contentFrame");
            if (iframe && iframe.contentWindow) {
                try {
                    const doc = iframe.contentWindow.document;
                    iframe.style.height = doc.body.scrollHeight + "px"; // Initial height
                } catch (e) {
                    console.log("Cannot access iframe content:", e);
                    iframe.style.height = "1000px"; // Default height if error
                }
            }
        });

        // Recalculate height on resize
        window.addEventListener("resize", function () {
            const iframe = document.getElementById("contentFrame");
            if (iframe && iframe.contentWindow) {
                try {
                    const doc = iframe.contentWindow.document;
                    iframe.style.height = doc.body.scrollHeight + "px";
                } catch (e) {
                    console.log("Resize error:", e);
                }
            }
        });

        // Handle iframe load
        window.addEventListener("DOMContentLoaded", function () {
            const iframe = document.getElementById("contentFrame");
            if (iframe) {
                iframe.onload = function () {
                    try {
                        iframe.style.height = iframe.contentWindow.document.body.scrollHeight + "px";
                    } catch (e) {
                        console.log("Onload error:", e);
                    }
                };
            }
        });
    </script>
</body>

</html>