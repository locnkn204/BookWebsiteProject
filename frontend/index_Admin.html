<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOOK WEBSITE ADMIN</title>
    <link href="bootstrap-5.3.5-dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Link Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            background-color: #F0F0F0;
        }

        nav {
            position: sticky;
            top: 0;
            z-index: 1020;
            background: rgba(0, 0, 0, 0.92);
        }

        .hr_DanhMuc {
            width: 90%;
            margin: 5px;
        }

        .dropdown-item {
            margin-left: 2px;
        }

        .dropdown-item:hover {
            background: linear-gradient(135deg, #af4949, #55b8a9, #8256ce);
            color: #fff;
            font-weight: bolder;
            font-size: medium;
        }

        .a_click {
            color: white;
            text-decoration: none;
            cursor: pointer;
        }

        .a_click:hover {
            color: black;
        }

        .dropdown-menu {
            background: #212529c7;
            color: #fff;
        }

        .dropdown-item {
            color: white;
        }

        /* Desktop hover effect */
        @media (min-width: 992px) {
            .nav-item.dropdown:hover .dropdown-menu {
                display: block;
                margin-top: 0;
            }
        }

        iframe {
            margin-bottom: 0 !important;
            padding-bottom: 0 !important;
            display: block;
        }

        footer {
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 992px) {
            .navbar-brand img {
                width: 250px !important;
            }

            .navbar-nav {
                margin-left: 0 !important;
                margin-right: 0 !important;
                gap: 0 !important;
            }

            .navbar-nav .nav-link {
                padding: 0.8rem 1rem;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            .dropdown-menu {
                min-width: 100% !important;
                position: static !important;
            }

            .d-flex.align-items-center {
                flex-direction: column;
                gap: 10px !important;
                width: 100%;
                margin-top: 15px;
            }

            .d-flex.align-items-center input {
                width: 100% !important;

            }

            .d-flex.align-items-center button {
                margin: 0 !important;
                width: 100%;
            }

            .d-flex.align-items-center .btn {
                margin-bottom: 5px;
            }

            /* Mobile: Ẩn dropdown admin và hiện button */
            .admin-dropdown {
                display: none !important;
            }

            .admin-button-mobile {
                display: block !important;
                width: 100%;
                margin-bottom: 5px;
            }
        }

        /* Desktop: Hiện dropdown admin và ẩn button */
        @media (min-width: 993px) {
            .admin-dropdown {
                display: block !important;
            }

            .admin-button-mobile {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .navbar-brand {
                margin-left: 1rem !important;
            }

            .navbar-brand img {
                width: 200px !important;
            }

            .dropdown-menu .row {
                flex-direction: column;
            }

            .dropdown-menu .col-4 {
                width: 100%;
                margin-bottom: 10px;
            }

            .modal-dialog {
                margin: 1rem;
            }

            .modal-content {
                font-size: 0.9rem;
            }

            .modal-title {
                font-size: 1.5rem !important;
            }

            footer .row {
                text-align: center !important;
            }

            footer .col-6 {
                width: 100%;
                margin-bottom: 20px;
            }

            footer .ms-5 {
                margin-left: 0 !important;
            }
        }

        @media (max-width: 576px) {
            .navbar-brand img {
                width: 180px !important;
            }

            .navbar-toggler {
                padding: 0.3rem 0.5rem;
                font-size: 1rem;
            }

            .modal-title {
                font-size: 1.3rem !important;
            }

            .btn {
                font-size: 0.9rem;
                padding: 0.5rem 0.8rem;
            }

            .dropdown-menu {
                padding: 1rem !important;
                font-size: 0.9rem;
            }

            .navbar-nav .nav-link {
                font-size: 0.95rem;
                padding: 0.7rem 0.8rem;
            }

            footer {
                padding: 2rem 0 1.5rem !important;
            }

            footer h5,
            footer h6 {
                font-size: 1.1rem;
            }

            footer p,
            footer .small {
                font-size: 0.85rem !important;
            }
        }

        /* Ensure proper spacing on mobile */
        @media (max-width: 768px) {
            .container-fluid {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
        }
    </style>
</head>

<body>
    <div class="container-fluid p-0">
        <nav class="navbar navbar-expand-lg  navbar-dark sticky-top  "> <!--Hoặc sài sticky -->
            <div class="container-fluid">
                <a href="index_Admin.html" class="navbar-brand ms-5">
                    <img src="https://bookwebsitedata.blob.core.windows.net/media/data/Hinh/image-Photoroom.png" width="300" alt="">
                </a>
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-content">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbar-content">
                    <ul class="navbar-nav ms-2 gap-2 me-5">
                        <li class="nav-item"><a class="nav-link active" href="index_Admin.html">Trang chủ</a></li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"><i
                                    class="fa-solid fa-list-ul"></i> Danh Mục</a>
                            <ul class="dropdown-menu p-3 " style="min-width: 700px;">
                                <div class="row">
                                    <div class="col-4">
                                        <li><a class="dropdown-item " href="#">Mới cập nhật</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                        <li><a class="dropdown-item" href="#">Được đề xuất</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                        <li><a class="dropdown-item" href="#">Sách nổi bật</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                    </div>
                                    <div class="col-4">
                                        <li><a class="dropdown-item " href="#">Sách đã hoàn thành</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                        <li><a class="dropdown-item" href="#">Bảng Xếp Hạng</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                        <li><a class="dropdown-item" href="#">Đọc gần đây</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                    </div>
                                    <div class="col-4">
                                        <li><a class="dropdown-item " href="#">Sách Full</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                        <li><a class="dropdown-item" href="#">Sách Ngẫu Nhiên</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                        <li><a class="dropdown-item" href="#">Cho bạn hôm nay</a>
                                            <hr class="mx-auto hr_DanhMuc">
                                        </li>
                                    </div>

                                </div>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle " href="#" data-bs-toggle="dropdown"
                                onclick="laydanhsachtheloai()"><i class="fa-solid fa-layer-group"></i> Thể Loại</a>
                            <ul class="dropdown-menu" id="listtheloai">

                            </ul>
                        </li>

                        <li class="nav-item"><a class="nav-link" role="button" id="giongdoc" onclick="giongdoc()">Người
                                đọc</a></li>

                        <li class="nav-item"><a class="nav-link" href="About-Admin.html">About</a></li>
                    </ul>

                    <!-- Bên phải navbar: Search + Tài khoản Admin + Đăng xuất -->
                    <div class="d-flex align-items-center gap-2 ms-auto">
                        <input type="search" placeholder="Search" class="form-control" style="width: 500px;"
                            id="nhaptimkiem">
                        <button type="button" class="btn btn-outline-light me-5" onclick="timkiem()">Search</button>

                        <!-- Admin Dropdown (Desktop) -->
                        <li class="nav-item dropdown ms-5 me-2 admin-dropdown" style="list-style: none;">
                            <a href="#" class="btn btn-outline-light  rounded-circle" data-bs-toggle="dropdown">
                                <i class="fa-solid fa-user-tie position-relative"></i>
                                <span class="position-absolute  translate-middle badge rounded-pill "
                                    style="top: -5%; left: 20px;">
                                    <i class="fa-solid fa-crown text-warning fs-5"></i>
                                </span>
                            </a>
                            <ul class="dropdown-menu ">
                                <li><a class="dropdown-item " href="GiaoDienTargetTaiKhoanAdmin.html"> <i
                                            class="fa-solid fa-user-tie me-2"></i>Quyền Admin</a></li>
                            </ul>
                        </li>

                        <!-- Admin Button (Mobile) -->
                        <button class="btn btn-outline-light admin-button-mobile">
                            <a class="a_click" href="GiaoDienTargetTaiKhoanAdmin.html">
                                <i class="fa-solid fa-user-tie me-1"></i>Admin
                            </a>
                        </button>


                        <!-- Đăng xuất -->
                        <button class="btn btn-outline-light" id="dangxuat">
                            <a class="a_click"><i class="fa-solid fa-right-from-bracket"></i> Đăng xuất</a>
                        </button>
                    </div>
                </div>
        </nav>


        <!-- Phần BODY -->
        <iframe name="Chitietsach" id="Chitietsach" src="BodyBook.html" width="100%" frameborder="0"
            scrolling="no"></iframe>

        <!-- Phần FOOTER-->
        <footer class="bg-dark text-white pt-5 pb-4 ">
            <div class="container text-center text-md-start">
                <div class="row justify-content-center">

                    <!-- Cột 1: Logo + Mô tả -->
                    <div class="col-6">
                        <h5 class="text-warning fw-bold">BOOK <span class="text-white">WEBSITE</span></h5>
                        <p class="small fs-6 fw-semibold text-secondary">
                            Đây là sản phẩm đầu tay của nhóm Delta, nhằm tạo ra một thư viện sách nói và truyện audio
                            miễn phí cho mọi người. Ứng dụng công nghệ AI hiện đại giúp tăng trải nghiệm học tập và giải
                            trí dễ tiếp cận hơn.
                        </p>
                        <p class="small fw-semibold fs-6 text-secondary mb-0">
                            Mọi thắc mắc về Website:
                            <a href="mailto:contact.deltacrew@gmail.com"
                                class="text-secondary fw-bold">contact.deltacrew@gmail.com</a>
                        </p>
                    </div>

                    <!-- Cột 3: Chính sách -->
                    <div class="col-6">
                        <h6 class="text-uppercase fw-bold text-warning mb-3 ms-5">Thông tin Liên hệ</h6>
                        <ul class="list-unstyled fs-6 small ms-5">
                            <li class="mb-2"><a href="#" class="text-decoration-none text-secondary "><i
                                        class="fa-solid fa-location-dot me-1"></i> <b>Địa Chỉ: </b>HCMC, VietNam</a></li>
                            <li class="mb-2"><a href="#" class="text-decoration-none text-secondary "><i
                                        class="fa-solid fa-phone-volume me-1"></i> <b>Điện thoại: </b>0777888xxx</a>
                            </li>
                            <li><a href="#" class="text-decoration-none text-secondary "><i
                                        class="fa-solid fa-envelope me-1"></i> <b>Email: </b>contact.deltacrew@gmail.com</a>
                            </li>
                        </ul>
                    </div>


                </div>

                <hr class="border-secondary my-4">

                <!-- Copyright -->
                <div class="text-center text-secondary small">
                    &copy; 2025 BOOKWEBSITE — Kho sách miễn phí cho cộng đồng.
                </div>
            </div>
        </footer>

    </div>


    <script>
        // xoá đi thanh scroll bên phải (do html chính nhúng iframe )
        //      window.addEventListener("DOMContentLoaded", function () {
        //     const iframe = document.getElementById("Chitietsach");
        //     iframe.onload = function () {
        //         iframe.style.height = iframe.contentWindow.document.body.scrollHeight + "px";
        //     };
        // });
        function giongdoc() {
            document.getElementById('Chitietsach').src = 'Listgiong.html';
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function safeParseJSON(jsonString, defaultValue = []) {
            try {
                const value = jsonString ? JSON.parse(jsonString) : defaultValue;
                return Array.isArray(value) ? value : defaultValue; // Đảm bảo trả về mảng
            } catch (err) {
                console.error('Lỗi parse JSON:', err);
                return defaultValue; // Trả về giá trị mặc định nếu lỗi
            }
        }
        const taikhoan = safeParseJSON(localStorage.getItem('dangnhap'));
        /// Hàm lấy danh sách thể loại từ database qua api '/api/theloai'
        async function laydanhsachtheloai() {
            try {
                const response = await fetch('https://donateabookdeltacrew.azurewebsites.net/api/theloai', {
                    method: 'GET'
                });
                const theloais = await response.json();
                const listtheloai = document.getElementById('listtheloai');
                listtheloai.innerHTML = '';
                theloais.forEach(theloai => {
                    const li = document.createElement('li');
                    li.innerHTML = '<a class="dropdown-item" href="#">' + theloai.TENTHELOAI + '</a>';
                    listtheloai.appendChild(li);
                });
            } catch (err) {
                console.error('Lỗi:', err);
            }
        }

        // Hàm tìm kiếm
        async function timkiem() {
            const data1 = document.getElementById("nhaptimkiem").value.trim();
            if (!data1) {
                alert("Vui long nhap thong tin tim kiem");
                return;
            }

            try {
                const response = await fetch(`https://donateabookdeltacrew.azurewebsites.net/api/timkiem?query=${encodeURIComponent(data1)}`, {
                    method: 'GET'
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                    return;
                }
                const ketqua = await response.json();

                if (ketqua.ketquatimkiem.length > 0) {
                    const ketquatimkiemData = ketqua.ketquatimkiem || [];
                    localStorage.setItem('ketquatimkiem', JSON.stringify(ketquatimkiemData));
                    localStorage.setItem('isSearch', 'true');
                    const iframe = document.getElementById("Chitietsach");
                    iframe.src = ketqua.redirect;
                } else {
                    alert("khong tim thay ket qua nao");
                    return;
                }
            } catch (err) {
                console.error('Lỗi:', err);
            }
        }
        document.getElementById("nhaptimkiem").addEventListener("keypress", function (e) {
            if (e.key == 'Enter') {
                timkiem();
            }
        })

        // Tìm kiếm theo thể loại
        document.getElementById("listtheloai").addEventListener("click", function (e) {
            const data = e.target.closest('.dropdown-item');
            timkiemtheloai(data.textContent);
        })

        async function timkiemtheloai(theloaitimkiem) {
            const data = theloaitimkiem;
            if (!data) {
                alert("Vui long nhap thong tin tim kiem");
                return;
            }

            try {
                const response = await fetch(`https://donateabookdeltacrew.azurewebsites.net/api/timkiemtheloai?query=${encodeURIComponent(data)}`, {
                    method: 'GET'
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                    return;
                }
                const ketqua = await response.json();
                const ketquatimkiemData = ketqua.ketquatimkiem || [];
                if (ketquatimkiemData.length > 0) {
                    localStorage.setItem('ketquatimkiem', JSON.stringify(ketquatimkiemData));
                    localStorage.setItem('isSearch', 'true');
                    const iframe = document.getElementById("Chitietsach");
                    iframe.src = ketqua.redirect;
                } else {
                    alert("Không tìm thấy kết quả nào");
                    return;
                }
            } catch (err) {
                console.error('Lỗi:', err);
            }
        }

        // đăng xuất
        document.getElementById("dangxuat").addEventListener("click", function () {
            const data = JSON.parse(localStorage.getItem('dangnhap') || []);
            const taikhoan = data[0];
            dangxuat(taikhoan.tentaikhoan);
        })

        async function dangxuat(taikhoan) {
            try {
                const response = await fetch('https://donateabookdeltacrew.azurewebsites.net/api/dangxuat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ taikhoan })
                });
                if (response.ok) {
                    alert("đăng xuất thành công");
                    localStorage.removeItem('dangnhap');
                    localStorage.removeItem('ketquatimkiemyeuthich');
                    localStorage.removeItem('listsachyeuthich');
                    window.location.href = 'index.html';
                } else {
                    alert("đăng xuất thất bại");
                    return;
                }
            } catch (err) {
                console.error('Lỗi:', err);
            }
        }

        window.addEventListener("DOMContentLoaded", function () {
            const iframe = document.getElementById("Chitietsach");
            iframe.onload = function () {
                // Đặt chiều cao ban đầu với khoảng đệm
                iframe.style.height = "1000px"; // Giá trị tạm thời
            };

            // Xử lý khi nhận message từ iframe
            window.addEventListener("message", function (event) {
                if (event.data && event.data.height) {
                    const iframe = document.getElementById("Chitietsach");
                    if (iframe) {
                        iframe.style.height = event.data.height + "px"; // Chỉ sử dụng chiều cao thực tế
                    }
                }
            });

            // Xử lý khi trang tải xong
            window.addEventListener("load", function () {
                const iframe = document.getElementById("Chitietsach");
                if (iframe && iframe.contentWindow) {
                    try {
                        const doc = iframe.contentWindow.document;
                        iframe.style.height = doc.body.scrollHeight + "px"; // Chiều cao thực tế ban đầu
                    } catch (e) {
                        console.log("Không thể truy cập nội dung iframe:", e);
                        iframe.style.height = "1000px"; // Giá trị mặc định nếu lỗi
                    }
                }
            });
        });
        (function () { if (!window.chatbase || window.chatbase("getState") !== "initialized") { window.chatbase = (...arguments) => { if (!window.chatbase.q) { window.chatbase.q = [] } window.chatbase.q.push(arguments) }; window.chatbase = new Proxy(window.chatbase, { get(target, prop) { if (prop === "q") { return target.q } return (...args) => target(prop, ...args) } }) } const onLoad = function () { const script = document.createElement("script"); script.src = "https://www.chatbase.co/embed.min.js"; script.id = "pZmBRIKTwTgRS_esCfk_p"; script.domain = "www.chatbase.co"; document.body.appendChild(script) }; if (document.readyState === "complete") { onLoad() } else { window.addEventListener("load", onLoad) } })();
    </script>

    <script src="bootstrap-5.3.5-dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>